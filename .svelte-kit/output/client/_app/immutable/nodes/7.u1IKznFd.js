import"../chunks/DsnmJJEf.js";import"../chunks/OiL74QB5.js";import{aa as Xe,aj as ge,ak as $e,ab as O,ac as z,a as o,ad as er,g as e,m as f,s as r,ae as s,ag as n,af as t,ao as Z,ah as I,t as ae,n as rr,ai as ne}from"../chunks/DFUQbp1x.js";import{e as P,s as ie}from"../chunks/BrEPatKm.js";import{i as m}from"../chunks/Rfqus09g.js";import{r as be,s as oe}from"../chunks/9XHtB8tL.js";import{s as F,c as sr}from"../chunks/C8k8eT28.js";import{t as A,s as G,f as tr,a as we}from"../chunks/6L04T-A-.js";import{b as ke}from"../chunks/CzZhIt5y.js";import{i as ar}from"../chunks/Dw2NSaBM.js";import{s as ir,a as or}from"../chunks/D6rtiNno.js";import{s as lr,g as le}from"../chunks/Dd8LfxSm.js";const nr=()=>{const W=lr;return{page:{subscribe:W.page.subscribe},navigating:{subscribe:W.navigating.subscribe},updated:W.updated}},vr={subscribe(W){return nr().page.subscribe(W)}};var dr=O('<div class="glass-header svelte-654myr"><button class="back-btn svelte-654myr" aria-label="Back"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></button></div>'),cr=O("<div><span> </span></div>"),pr=O('<div class="title-section svelte-654myr"><h1 class="main-title svelte-654myr">FORGOT PASSWORD</h1> <p class="sub-title svelte-654myr">Please enter your email to reset the password</p></div> <div class="form-section svelte-654myr"><div class="form-group svelte-654myr"><label class="label svelte-654myr" for="email">Email</label> <div><input id="email" type="email" placeholder="Enter your email" class="svelte-654myr"/></div></div> <!> <button class="primary-btn svelte-654myr"><!></button></div>',1),mr=O('<div class="icon-wrapper svelte-654myr"><div class="success-circle svelte-654myr"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></div></div> <div class="title-section svelte-654myr" style="text-align: center;"><h1 class="main-title svelte-654myr">CHECK YOUR EMAIL</h1> <p class="sub-title svelte-654myr">We sent a reset link to <span style="color: white; font-weight: 600;"> </span><br/>Please click the link in that email.</p></div> <div class="footer-text svelte-654myr">Havenâ€™t got the email yet? <button class="resend-link svelte-654myr">Resend email</button></div>',1),ur=O('<div class="loading-state svelte-654myr"><div class="spinner svelte-654myr"></div> <p>Verifying link...</p></div>'),fr=O('<div class="message-container error svelte-654myr"><span> </span></div>'),yr=O('<div class="error-state svelte-654myr"><div class="error-icon svelte-654myr">!</div> <h2 class="main-title svelte-654myr" style="text-align:center; font-size: 22px;">Invalid Link</h2> <p class="sub-title svelte-654myr" style="text-align:center; margin-bottom:24px;">This password reset link is invalid or has expired.</p> <!> <button class="primary-btn svelte-654myr">GO TO LOGIN</button> <div style="margin-top:16px; text-align:center;"><button class="resend-link svelte-654myr">Request new link</button></div></div>'),_r=ne('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>'),hr=ne('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),gr=ne('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>'),br=ne('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),wr=O("<div><span> </span></div>"),kr=O('<div class="title-section svelte-654myr"><h1 class="main-title svelte-654myr">SET NEW PASSWORD</h1> <p class="sub-title svelte-654myr">Create a new password. Ensure it differs from previous ones.</p></div> <div class="form-section svelte-654myr"><div class="form-group svelte-654myr"><label class="label svelte-654myr" for="new-password">Password</label> <div><input id="new-password" placeholder="Enter new password" class="svelte-654myr"/> <button type="button" class="toggle-password svelte-654myr"><!></button></div></div> <div class="form-group svelte-654myr"><label class="label svelte-654myr" for="confirm-password">Confirm Password</label> <div><input id="confirm-password" placeholder="Confirm new password" class="svelte-654myr"/> <button type="button" class="toggle-password svelte-654myr"><!></button></div></div> <!> <button class="primary-btn svelte-654myr"><!></button></div>',1),xr=O('<div class="icon-wrapper svelte-654myr"><div class="success-circle svelte-654myr"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></div></div> <div class="title-section svelte-654myr" style="text-align: center;"><h1 class="main-title svelte-654myr">PASSWORD RESET</h1> <p class="sub-title svelte-654myr">Your password has been successfully reset.<br/>Click confirm to login.</p></div> <button class="primary-btn svelte-654myr" type="button">CONFIRM</button>',1),Pr=O('<div class="app-screen svelte-654myr"><!> <div><div class="content-wrapper svelte-654myr"><div><!></div></div></div></div>');function Dr(W,xe){Xe(xe,!1);const Pe=()=>or(vr,"$page",je),[je,Ie]=ir(),M=f(),B=f(),ve="http://158.108.102.14:8001";let u=f(1),y=f(!1),Q=f(!1),X=f(!1);async function Me(i){r(Q,!0),r(u,1),J(),await new Promise(v=>setTimeout(v,800));try{if(!i||i.length<5)throw new Error("Invalid Token format");r(X,!0)}catch{r(X,!1),S("This password reset link is invalid or has expired.","error")}finally{r(Q,!1)}}let j=f(""),de=f("error"),$,H=f(""),L=f(""),V=f(""),ce=f(""),ee=f(!1),re=f(!1);function S(i,v="error",N=""){$&&clearTimeout($),r(j,i),r(de,v),N&&r(H,N),$=setTimeout(()=>{r(j,""),r(H,"")},5e3)}function J(){e(j)&&(r(j,""),r(H,""),$&&clearTimeout($))}function Ne(i){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)}function Re(i){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(i)}async function Se(){if(J(),!e(L))return S("Please enter your email.","error","email");if(!Ne(e(L)))return S("Invalid email address.","error","email");r(y,!0);try{const i=await fetch(`${ve}/api/users/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(L)})}),v=await i.json().catch(()=>({}));i.ok?r(u,2):S(v.detail||"Failed to send email.","error","email")}catch{S("Cannot connect to server.","error","email")}finally{r(y,!1)}}console.log("API_BASE =",ve);async function Be(){if(J(),!e(M)||!e(X))return S("Invalid session. Please request a new link.","error");if(!e(V))return S("Enter a new password.","error","password");if(!Re(e(V)))return S("Password must be 8+ chars & include a number.","error","password");if(e(V)!==e(ce))return S("Passwords do not match.","error","confirmPassword");r(y,!0);try{const i=await fetch(`${ve}/api/users/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e(M),new_password:e(V)})}),v=await i.json().catch(()=>({}));i.ok?r(u,2):(S(v.detail||"Failed to reset password. Token may have expired.","error"),v.detail&&v.detail.includes("expired")&&r(X,!1))}catch{S("Cannot connect to server.","error")}finally{r(y,!1)}}ge(()=>Pe(),()=>{r(M,Pe().url.searchParams.get("token"))}),ge(()=>e(M),()=>{r(B,e(M)?"reset":"request")}),ge(()=>(e(B),e(M)),()=>{e(B)==="reset"&&e(M)?Me(e(M)):r(Q,!1)}),$e(),ar();var pe=Pr(),Te=s(pe);{var De=i=>{var v=dr(),N=s(v);t(v),z(()=>N.disabled=e(y)||e(Q)),P("click",N,()=>{e(B)==="reset"?le("/auth/login"):e(u)===2?r(u,1):le("/auth/login")}),o(i,v)};m(Te,i=>{e(B)==="reset"&&e(u)===2||i(De)})}var me=n(Te,2);let Ee;var Ce=s(me),ue=s(Ce),ze=s(ue);{var We=i=>{var v=Z(),N=I(v);{var fe=_=>{var T=pr(),K=I(T),q=n(K,2),R=s(q),h=n(s(R),2),p=s(h);be(p),t(h),t(R);var w=n(R,2);{var D=l=>{var d=cr(),E=s(d),C=s(E,!0);t(E),t(d),z(()=>{F(d,1,`message-container ${e(de)??""}`,"svelte-654myr"),ie(C,e(j))}),A(3,d,()=>G,()=>({duration:200})),o(l,d)};m(w,l=>{e(j)&&l(D)})}var k=n(w,2),g=s(k);{var x=l=>{var d=ae("SENDING...");o(l,d)},b=l=>{var d=ae("SEND LINK");o(l,d)};m(g,l=>{e(y)?l(x):l(b,!1)})}t(k),t(q),z(()=>{F(h,1,`input-field ${e(H)==="email"?"error-border":""}`,"svelte-654myr"),p.disabled=e(y),k.disabled=e(y)}),A(1,K,()=>G),ke(p,()=>e(L),l=>r(L,l)),P("input",p,J),P("click",k,Se),A(1,q,()=>G),o(_,T)},ye=_=>{var T=Z(),K=I(T);{var q=R=>{var h=mr(),p=I(h),w=n(p,2),D=n(s(w),2),k=n(s(D)),g=s(k,!0);t(k),rr(2),t(D),t(w);var x=n(w,2),b=n(s(x));t(x),z(()=>{ie(g,e(L)),b.disabled=e(y)}),A(1,p,()=>we,()=>({duration:400,start:.5})),A(1,w,()=>G),P("click",b,()=>{r(u,1),Se()}),o(R,h)};m(K,R=>{e(u)===2&&R(q)},!0)}o(_,T)};m(N,_=>{e(u)===1?_(fe):_(ye,!1)})}o(i,v)},qe=i=>{var v=Z(),N=I(v);{var fe=_=>{var T=ur();A(1,T,()=>tr),o(_,T)},ye=_=>{var T=Z(),K=I(T);{var q=h=>{var p=yr(),w=n(s(p),6);{var D=b=>{var l=fr(),d=s(l),E=s(d,!0);t(d),t(l),z(()=>ie(E,e(j))),o(b,l)};m(w,b=>{e(j)&&b(D)})}var k=n(w,2),g=n(k,2),x=s(g);t(g),t(p),P("click",k,()=>le("/auth/login")),P("click",x,()=>{r(B,"request"),r(u,1),r(M,null)}),A(1,p,()=>we),o(h,p)},R=h=>{var p=Z(),w=I(p);{var D=g=>{var x=kr(),b=I(x),l=n(b,2),d=s(l),E=n(s(d),2),C=s(E);be(C);var U=n(C,2),Fe=s(U);{var Ge=a=>{var c=_r();o(a,c)},He=a=>{var c=hr();o(a,c)};m(Fe,a=>{e(ee)?a(Ge):a(He,!1)})}t(U),t(E),t(d);var _e=n(d,2),he=n(s(_e),2),Y=s(he);be(Y);var se=n(Y,2),Le=s(se);{var Ve=a=>{var c=gr();o(a,c)},Je=a=>{var c=br();o(a,c)};m(Le,a=>{e(re)?a(Ve):a(Je,!1)})}t(se),t(he),t(_e);var Ae=n(_e,2);{var Ke=a=>{var c=wr(),Oe=s(c),Qe=s(Oe,!0);t(Oe),t(c),z(()=>{F(c,1,`message-container ${e(de)??""}`,"svelte-654myr"),ie(Qe,e(j))}),A(3,c,()=>G,()=>({duration:200})),o(a,c)};m(Ae,a=>{e(j)&&a(Ke)})}var te=n(Ae,2),Ue=s(te);{var Ye=a=>{var c=ae("UPDATING...");o(a,c)},Ze=a=>{var c=ae("RESET PASSWORD");o(a,c)};m(Ue,a=>{e(y)?a(Ye):a(Ze,!1)})}t(te),t(l),z(()=>{F(E,1,`input-field ${e(H)==="password"?"error-border":""}`,"svelte-654myr"),oe(C,"type",e(ee)?"text":"password"),C.disabled=e(y),oe(U,"aria-label",e(ee)?"Hide password":"Show password"),F(he,1,`input-field ${e(H)==="confirmPassword"?"error-border":""}`,"svelte-654myr"),oe(Y,"type",e(re)?"text":"password"),Y.disabled=e(y),oe(se,"aria-label",e(re)?"Hide password":"Show password"),te.disabled=e(y)}),A(1,b,()=>G),ke(C,()=>e(V),a=>r(V,a)),P("input",C,J),P("click",U,()=>r(ee,!e(ee))),ke(Y,()=>e(ce),a=>r(ce,a)),P("input",Y,J),P("click",se,()=>r(re,!e(re))),P("click",te,Be),A(1,l,()=>G),o(g,x)},k=g=>{var x=Z(),b=I(x);{var l=d=>{var E=xr(),C=I(E),U=n(C,4);A(1,C,()=>we,()=>({duration:400,start:.5})),P("click",U,()=>le("/auth/login")),o(d,E)};m(b,d=>{e(u)===2&&d(l)},!0)}o(g,x)};m(w,g=>{e(u)===1?g(D):g(k,!1)})}o(h,p)};m(K,h=>{e(X)?h(R,!1):h(q)},!0)}o(_,T)};m(N,_=>{e(Q)?_(fe):_(ye,!1)})}o(i,v)};m(ze,i=>{e(B)==="request"?i(We):i(qe,!1)})}t(ue),t(Ce),t(me),t(pe),z(()=>{Ee=F(me,1,"scroll-container svelte-654myr",null,Ee,{"pt-120":e(B)==="reset"&&e(u)===2}),F(ue,1,sr(e(u)===2?"success-card":"form-card"),"svelte-654myr")}),o(W,pe),er(),Ie()}export{Dr as component};
